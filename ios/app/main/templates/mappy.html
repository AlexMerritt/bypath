<ion-view view-title="Map" hide-nav-bar="true">
  <ion-content class="padding" scroll="false" >

    <!-- Search bar -->
    <h5>Search</h5>
    <div class="item item-input">
      <input type="text" ng-model="mappyCtrl.filters.search" placeholder="What are you looking for?">
    </div>

    <!-- Filter dropdown -->
    <h5>Filter by Incidents</h5>
    <div id="optionsContainer">
        <div id="filterContainer">
            <select id="incidentSelector" ng-model="mappyCtrl.filtersSelected" ng-options="key for (key, value) in mappyCtrl.filters" multiple></select>
        </div>
        <div id="resultCountContainer">
            <button style="margin: 5px;" class="button button-small button-clear button-positive" ui-sref="main.list">
              {{ mappyCtrl.data.filteredComplaints.length }} results
            </button>
        </div>
    </div>

    <!-- Leaflet Map -->
    <leaflet id="map" lf-center="mapCenter" markers="mapMarkers"></leaflet>

    <!-- Selected Complaint Card -->
    <div class="card padding" style="margin-bottom: 0px;" ui-sref="main.list-detail({objectId: mappyCtrl.data.selectedComplaint.id})" ng-if="mappyCtrl.data.selectedComplaint">
        <div class="item item-text-wrap item-icon-right">
            <h2>{{mappyCtrl.data.selectedComplaint.title}}</h2>
            <p>{{mappyCtrl.data.selectedComplaint.location}}</p>
            <span class="type type-balanced type-small">Opened: </span>
            <span class="type type-muted type-small">{{mappyCtrl.data.selectedComplaint.open | date:'dd MMM'}}</span>
        </div>
    </div>
  </ion-content>
</ion-view>
